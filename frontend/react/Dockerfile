#FROM node:24-alpine
#ARG api_base_url
#WORKDIR /app
#COPY package*.json .
#RUN npm i --silent
#COPY . .
#RUN echo "VITE_API_BASE_URL=${api_base_url}" > .env
#EXPOSE 5173
#CMD ["npm", "run", "dev"]
#
#to build the frontend image
#docker build . -t muhammedbakur/customer-management-react --build-arg api_base_url=https://customer-management-api-3y8d.onrender.com

FROM node:24-alpine

# ğŸ‘‡ Ù†Ø¹Ø±Ù‘Ù Ù…ØªØºÙŠØ± Ø§Ù„Ù€ API Base URL
ARG api_base_url

WORKDIR /app

COPY package*.json ./
RUN npm install --silent

COPY . .

# ğŸ‘‡ Ù†Ø¶Ø¹ Ù…ØªØºÙŠØ± Ø§Ù„Ø¨ÙŠØ¦Ø© ÙÙŠ .env
RUN echo "VITE_API_BASE_URL=${api_base_url}" > .env

# ğŸ‘‡ Ù†Ø¬Ù‡Ø² Ù†Ø³Ø®Ø© Ø¥Ù†ØªØ§Ø¬
RUN npm run build

# ğŸ‘‡ Ù†Ø«Ø¨Øª Ø³ÙŠØ±ÙØ± Ù„ØªØ´ØºÙŠÙ„ build Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
RUN npm install -g serve

# ğŸ‘‡ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ù†ÙØ° 80 (Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Render)
EXPOSE 80

# ğŸ‘‡ Ù†Ø´ØºÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¨Ø¯Ù„ npm run dev
CMD ["serve", "-s", "dist", "-l", "80"]
